# ðŸš€ Quick Start Guide

## Prerequisites

```bash
pip install requests python-jose
```

## Usage

### 1. **Full System Test** (Recommended)

Tests health, sends events, then queries them back:

```bash
python scripts/test_system.py test
```

Expected output:
```
âœ… Telemetry API: healthy
âœ… GraphQL API: healthy
âœ… 3 events sent successfully
âœ… Found 10 events in database
âœ…âœ…âœ… FULL SYSTEM TEST PASSED!
```

---

### 2. **Send Events Only**

```bash
# Send 5 events (default)
python scripts/test_system.py send

# Send 20 events
python scripts/test_system.py send --count 20
```

---

### 3. **Query Events Only**

```bash
# Query latest 10 events (default)
python scripts/test_system.py query

# Query latest 50 events
python scripts/test_system.py query --limit 50
```

---

### 4. **Health Check Only**

```bash
python scripts/test_system.py health
```

Output:
```
âœ… Telemetry API: {'status': 'healthy', 'service': 'producer'}
âœ… GraphQL API: {'status': 'healthy', 'service': 'graphql_api'}
```

---

## What Events Are Sent?

The script sends realistic test events with:
- **Event Type**: `user.action`
- **Actions**: login, purchase, view_product, add_to_cart, logout
- **Users**: Rotates between `user-1`, `user-2`, `user-3`
- **Payload**: Includes amount, count, and metadata (IP, user agent)

Example event:
```json
{
  "event_type": "user.action",
  "user_id": "user-1",
  "payload": {
    "action": "purchase",
    "amount": 10.5,
    "count": 1,
    "metadata": {
      "ip": "192.168.1.1",
      "user_agent": "test-client/1.0"
    }
  }
}
```

---

## Troubleshooting

### "Connection refused" or "Timeout"
- Check if APIs are running: `python scripts/test_system.py health`
- Verify ALB is accessible: `curl http://event-platform-alb-95530675.us-east-1.elb.amazonaws.com:8000/health`

### "401 Unauthorized"
- JWT token is auto-generated by the script
- If issues persist, check `JWT_SECRET` matches in the script and API

### "No events found"
- Events take ~5-10 seconds to process through Kafka â†’ Processor â†’ DynamoDB
- Try querying again after a few seconds

---

## Advanced Usage

### Custom Configuration

Edit the script variables at the top:
```python
ALB_DNS = "your-alb-dns.amazonaws.com"
JWT_SECRET = "your-secret-key"
```

### Integration with CI/CD

```bash
# Exit code 0 if successful, 1 if failed
python scripts/test_system.py test
echo $?  # Check exit code
```

---

## What This Demonstrates

âœ… **Event Ingestion** - POST to Telemetry API with JWT auth  
âœ… **Kafka Streaming** - Events flow through Redpanda  
âœ… **Event Processing** - Consumer writes to DynamoDB & S3  
âœ… **GraphQL Queries** - Retrieve events with flexible queries  
âœ… **Idempotency** - Safe to run multiple times  
âœ… **Scalability** - Ready for production workloads  

---

## Next Steps

- View events in AWS Console: DynamoDB â†’ `EventsHot` table
- Check raw JSON in S3: `event-platform-raw-events` bucket
- Monitor metrics: Prometheus (port 9090), Grafana (port 3000)
- Scale consumers: Update ECS service desired count

